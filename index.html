<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Cache-Control" content="no-store, must-revalidate" />
    <link
      href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Preload critical brand assets - removed unused preload to fix "preloaded but not used" warning -->
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/brand/inkwell-favicon-32.png" />
    <link rel="icon" href="/assets/brand/inkwell-favicon.ico" />
    <link rel="apple-touch-icon" href="/assets/brand/inkwell-logo-icon-180.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Theme initialization - zero-dependency, no-flash, respects user choice AND system preferences -->
    <script>
      (function() {
        // Add loading class to prevent transition flash
        document.documentElement.classList.add('loading');

        // Check localStorage first
        const savedTheme = localStorage.getItem('theme');

        // Determine effective theme
        let theme;
        if (savedTheme) {
          theme = savedTheme;
        } else {
          // Respect system preference if no saved theme
          const prefersDark = window.matchMedia &&
            window.matchMedia('(prefers-color-scheme: dark)').matches;
          theme = prefersDark ? 'dark' : 'light';
        }

        // Apply theme immediately (before page render)
        if (theme === 'dark') {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }

        // Store resolved theme (so we know user's effective preference)
        if (!savedTheme) {
          localStorage.setItem('theme', theme);
        }
      })();
    </script>

    <!-- Theme meta tags -->
    <meta name="color-scheme" content="light dark" />
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#0b1323" media="(prefers-color-scheme: dark)" />
    <meta name="msapplication-TileColor" content="#D4AF37" />

    <!-- SEO Meta Tags -->
    <title>Inkwell – Where Writing Flows</title>
    <meta
      name="description"
      content="Inkwell is a comprehensive writing platform for authors, writers, and content creators. Organize your projects, track progress, and bring your stories to life."
    />
    <meta
      name="keywords"
      content="writing, authors, writing software, manuscript, novel writing, content creation, storytelling, creative writing"
    />
    <meta name="author" content="Inkwell" />

    <!-- Build ID for verification -->
    <!-- build-id: 2025-10-10T21:40:00 -->

    <!-- Canonical URL -->
    <link rel="canonical" href="https://inkwell.leadwithnexus.com" />

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Inkwell – Find Your Story, Weave It Well" />
    <meta
      property="og:description"
      content="Organize your writing projects, track progress, and bring your stories to life. The complete platform for creative writers and storytellers."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://inkwell.leadwithnexus.com" />
    <meta
      property="og:image"
      content="https://inkwell.leadwithnexus.com/assets/brand/inkwell-og-1200x630.png"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="Inkwell" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Inkwell – Find Your Story, Weave It Well" />
    <meta
      name="twitter:description"
      content="Organize your writing projects, track progress, and bring your stories to life. The complete platform for creative writers."
    />
    <meta
      name="twitter:image"
      content="https://inkwell.leadwithnexus.com/assets/brand/inkwell-og-1200x630.png"
    />
    <meta name="twitter:site" content="@inkwell" />

    <!-- PWA Configuration -->
    <meta name="background-color" content="#FFFFFF" />
    <meta name="display" content="standalone" />

    <!-- Ultra-early error/logger for boot-time diagnostics -->
    <script>
      window.inkwellBootProbe = {
        errors: [],
        logs: [],
        startTime: Date.now(),
        log: function (msg, data) {
          const entry = { time: Date.now() - this.startTime, msg, data };
          this.logs.push(entry);
          console.log(`[BOOT] ${msg}`, data || '');
          return entry;
        },
        error: function (msg, err) {
          const entry = { time: Date.now() - this.startTime, msg, error: err };
          this.errors.push(entry);
          console.error(`[BOOT ERROR] ${msg}`, err || '');
          return entry;
        },
      };

      // Catch global errors during boot
      window.addEventListener('error', function (event) {
        if (window.inkwellBootProbe) {
          window.inkwellBootProbe.error('Uncaught error', {
            message: event.message,
            filename: event.filename,
            lineno: event.lineno,
            colno: event.colno,
            stack: event.error?.stack,
          });
        }
      });

      window.inkwellBootProbe.log('Boot probe initialized');

      // Check for critical resources after DOM is ready
      // Note: This runs in <head>, so #root won't exist yet - check after DOMContentLoaded
      function checkRootElement() {
        try {
          window.inkwellBootProbe.log('DOM ready state', document.readyState);
          if (!document.getElementById('root')) {
            window.inkwellBootProbe.error('Root element not found');
          } else {
            window.inkwellBootProbe.log('Root element found');
          }
        } catch (e) {
          window.inkwellBootProbe.error('Error during DOM check', e);
        }
      }

      // Check immediately if DOM is already loaded, otherwise wait
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', checkRootElement);
      } else {
        checkRootElement();
      }
    </script>

    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Inkwell" />

    <!-- Microsoft Tiles -->
    <meta name="msapplication-TileColor" content="#1B2A41" />
    <meta name="msapplication-TileImage" content="/assets/brand/inkwell-logo-icon-192.png" />

    <!-- Early Error Logging -->
    <script>
      (function () {
        function log(type, msg, extra) {
          try {
            console[type]('[BOOT]', msg, extra || '');
          } catch {}
        }
        window.addEventListener('error', function (e) {
          log('error', 'window.onerror', {
            message: e.message,
            filename: e.filename,
            lineno: e.lineno,
            colno: e.colno,
            error: String(e.error || ''),
          });
        });
        window.addEventListener('unhandledrejection', function (e) {
          log('error', 'unhandledrejection', { reason: String(e.reason || '') });
        });
        log('log', 'boot probe started');
      })();
    </script>
  </head>
  <body class="font-sans bg-inkwell-white text-inkwell-navy">
    <div id="root"></div>
    <!-- Add monitoring for script loading -->
    <script>
      if (window.inkwellBootProbe) {
        window.inkwellBootProbe.log('About to load main script');

        // Monitor script loading
        document.addEventListener('DOMContentLoaded', function () {
          window.inkwellBootProbe.log('DOMContentLoaded fired');
        });

        window.addEventListener('load', function () {
          window.inkwellBootProbe.log('Window load complete');
          // Check for React mount after a slight delay
          setTimeout(function () {
            const rootEl = document.getElementById('root');
            if (rootEl && rootEl.childNodes.length === 0) {
              window.inkwellBootProbe.error('React did not mount after 1000ms');
            } else {
              window.inkwellBootProbe.log('UI appears to be mounted', {
                childCount: rootEl?.childNodes.length || 0,
              });
            }
          }, 1000);
        });
      }
    </script>
    <script
      type="module"
      src="/src/main.tsx"
      onerror="window.inkwellBootProbe && window.inkwellBootProbe.error('Failed to load main script')"
      onload="window.inkwellBootProbe && window.inkwellBootProbe.log('Main script loaded')"
    ></script>
  </body>
</html>
